<script type="text/babel">
    const IPStrategyFinder = () => {
      // State for app data
      const [strategies, setStrategies] = React.useState([]);
      const [loading, setLoading] = React.useState(true);
      const [accordions, setAccordions] = React.useState({
        ipRights: true,
        situation: true,
        preferences: false
      });
      
      // State for user selections
      const [selectedRights, setSelectedRights] = React.useState([]);
      const [selectedSituations, setSelectedSituations] = React.useState([]);
      const [preferences, setPreferences] = React.useState({
        timeCommitment: 0,
        investment: 0,
        commercialAgreements: 0,
        thirdPartyServices: 0,
        legalAction: 0
      });
      
      // Filtered and ranked strategies
      const [filteredStrategies, setFilteredStrategies] = React.useState([]);
      
      // Options for IP rights
      const ipRightsOptions = [
        { id: 'Patent', label: 'Patents', color: 'patent' },
        { id: 'Trade mark', label: 'Trade marks', color: 'trademark' },
        { id: 'Design', label: 'Design rights', color: 'design' },
        { id: 'PBR', label: 'Plant breeder\'s rights', color: 'pbr' },
        { id: 'Copyright', label: 'Copyright', color: 'copyright' },
        { id: 'Any', label: 'Any IP right', color: 'any' }
      ];
      
      // Options for situation
      const situationOptions = [
        { id: 'Accused', label: 'I\'ve been accused of infringing' },
        { id: 'Enforcement', label: 'I believe my IP has been infringed' },
        { id: 'Proactive', label: 'I\'m proactively protecting my IP' },
        { id: 'Future', label: 'I\'m considering my future options' },
        { id: 'Professional', label: 'I need support from an IP professional' }
      ];
      
      // Initialize data
      React.useEffect(() => {
        // Load strategies from the JSON data
        const strategiesData = [
          {
            id: 1,
            overtitle: "Patent opposition",
            title: "Challenge a new or amended patent",
            description: "Initiate a challenge to the validity of a new patent with IP Australia",
            responseType: ["Enforcement", "Accused", "Professional"],
            right: "Patent",
            scores: {
              timeCommitment: 7,
              investment: 7,
              commercialAgreements: 2,
              thirdPartyServices: 8,
              legalAction: 8
            }
          },
          {
            id: 2,
            overtitle: "Patent re-examination",
            title: "Challenge a granted patent",
            description: "Request a re-examination with IP Australia, to revoke or amend a granted patent",
            responseType: ["Enforcement", "Accused", "Professional"],
            right: "Patent",
            scores: {
              timeCommitment: 6,
              investment: 6,
              commercialAgreements: 2,
              thirdPartyServices: 7,
              legalAction: 7
            }
          },
          {
            id: 3,
            overtitle: "Court - Patent",
            title: "Seek binding, authoritative decisions",
            description: "Escalate a wide range of patent matters to court",
            responseType: ["Enforcement", "Accused", "Professional"],
            right: "Patent",
            scores: {
              timeCommitment: 9,
              investment: 10,
              commercialAgreements: 4,
              thirdPartyServices: 9,
              legalAction: 10
            }
          },
          {
            id: 4,
            overtitle: "Trade mark opposition",
            title: "Challenge the registration of a trade mark",
            description: "Initiate a trade mark opposition process against a new trademark with IP Australia",
            responseType: ["Enforcement", "Professional"],
            right: "Trade mark",
            scores: {
              timeCommitment: 6,
              investment: 6,
              commercialAgreements: 2,
              thirdPartyServices: 7,
              legalAction: 7
            }
          },
          {
            id: 5,
            overtitle: "Trade mark registration revocation",
            title: "Remove a trade mark from the register",
            description: "Let IP Australia know a recently registered trade mark should not have been registered",
            responseType: ["Enforcement", "Professional"],
            right: "Trade mark",
            scores: {
              timeCommitment: 5,
              investment: 5,
              commercialAgreements: 1,
              thirdPartyServices: 6,
              legalAction: 6
            }
          },
          {
            id: 6,
            overtitle: "Trade mark non-use action",
            title: "Remove a trade mark from the register",
            description: "Request IP Australia removes a trade mark from the register for non-use",
            responseType: ["Enforcement", "Professional"],
            right: "Trade mark",
            scores: {
              timeCommitment: 5,
              investment: 5,
              commercialAgreements: 1,
              thirdPartyServices: 6,
              legalAction: 6
            }
          },
          {
            id: 7,
            overtitle: "Court - Trade Mark",
            title: "Seek binding, authoritative decisions",
            description: "Escalate a wide range of trade mark matters to court",
            responseType: ["Enforcement", "Accused", "Professional"],
            right: "Trade mark",
            scores: {
              timeCommitment: 9,
              investment: 10,
              commercialAgreements: 4,
              thirdPartyServices: 9,
              legalAction: 10
            }
          },
          {
            id: 8,
            overtitle: "Interim court injunction order",
            title: "Stop infringing activity immediately",
            description: "Lodge an interim injunction order through court",
            responseType: ["Enforcement", "Professional"],
            right: "Any",
            scores: {
              timeCommitment: 7,
              investment: 9,
              commercialAgreements: 3,
              thirdPartyServices: 9,
              legalAction: 10
            }
          },
          {
            id: 9,
            overtitle: "World IP Organisation (WIPO)",
            title: "Resolve international disputes",
            description: "Seek dispute resolution through the WIPO Arbitration and Mediation Center",
            responseType: ["Enforcement", "Professional"],
            right: "Any",
            scores: {
              timeCommitment: 7,
              investment: 8,
              commercialAgreements: 6,
              thirdPartyServices: 8,
              legalAction: 7
            }
          },
          {
            id: 10,
            overtitle: "Alternative dispute resolution (ADR)",
            title: "Resolve conflicts with the help of experienced facilitators",
            description: "Understand more about the options in the ADR space.",
            responseType: ["Enforcement", "Accused", "Professional"],
            right: "Any",
            scores: {
              timeCommitment: 5,
              investment: 5,
              commercialAgreements: 7,
              thirdPartyServices: 7,
              legalAction: 4
            }
          },
          {
            id: 11,
            overtitle: "ASBFEO",
            title: "Access help tailored to resolve business disputes",
            description: "Australia Small Business & Family Enterprise Ombudsman (ASBFEO).",
            responseType: ["Enforcement", "Accused", "Professional"],
            right: "Any",
            scores: {
              timeCommitment: 4,
              investment: 3,
              commercialAgreements: 5,
              thirdPartyServices: 6,
              legalAction: 3
            }
          },
          {
            id: 12,
            overtitle: "Mediation",
            title: "Resolve IP issues with the help of a third party",
            description: "Invite the other party to enter into mediation to agree to mutually acceptable agreement.",
            responseType: ["Enforcement", "Professional"],
            right: "Any",
            scores: {
              timeCommitment: 5,
              investment: 4,
              commercialAgreements: 8,
              thirdPartyServices: 7,
              legalAction: 2
            }
          },
          {
            id: 13,
            overtitle: "Arbitration",
            title: "Resolve IP issues with the help of a third party",
            description: "Agree to be bound by the decision of a highly qualified third party assessment.",
            responseType: ["Enforcement", "Professional"],
            right: "Any",
            scores: {
              timeCommitment: 6,
              investment: 6,
              commercialAgreements: 8,
              thirdPartyServices: 8,
              legalAction: 5
            }
          },
          {
            id: 14,
            overtitle: "Letter of demand",
            title: "Demand the other party stops infringing",
            description: "Send a letter to the infringing party notifying them of potential infringement.",
            responseType: ["Enforcement", "Professional"],
            right: "Any",
            scores: {
              timeCommitment: 3,
              investment: 2,
              commercialAgreements: 4,
              thirdPartyServices: 5,
              legalAction: 3
            }
          },
          {
            id: 15,
            overtitle: "Informal contact",
            title: "Provide an opportunity to stop infringement",
            description: "Alert the alleged infringer of your registered rights to allow them to stop infringing.",
            responseType: ["Enforcement"],
            right: "Any",
            scores: {
              timeCommitment: 2,
              investment: 1,
              commercialAgreements: 3,
              thirdPartyServices: 1,
              legalAction: 1
            }
          },
          {
            id: 16,
            overtitle: "Informal contact",
            title: "Respond informally to accusations of IP infringement",
            description: "Let the accuser know about your circumstances.",
            responseType: ["Accused"],
            right: "Any",
            scores: {
              timeCommitment: 2,
              investment: 1,
              commercialAgreements: 3,
              thirdPartyServices: 1,
              legalAction: 1
            }
          },
          {
            id: 17,
            overtitle: "Negotiation",
            title: "Agree to a commercial arrangement",
            description: "Work with an IP professional to come to an agreement with another party.",
            responseType: ["Enforcement", "Accused", "Professional"],
            right: "Any",
            scores: {
              timeCommitment: 5,
              investment: 4,
              commercialAgreements: 9,
              thirdPartyServices: 6,
              legalAction: 2
            }
          },
          {
            id: 18,
            overtitle: "Takedown request",
            title: "Stop infringement facilitated online",
            description: "Request infringing material is removed from online marketplaces and platforms.",
            responseType: ["Enforcement"],
            right: "Trade mark; Copyright",
            scores: {
              timeCommitment: 3,
              investment: 2,
              commercialAgreements: 2,
              thirdPartyServices: 3,
              legalAction: 2
            }
          },
          {
            id: 19,
            overtitle: "Report IP crime or safety concerns",
            title: "Prevent risks to public interest",
            description: "Inform Government about risks to public health, crime, counterfeiting, frauds & scams.",
            responseType: ["Enforcement"],
            right: "Any",
            scores: {
              timeCommitment: 3,
              investment: 1,
              commercialAgreements: 1,
              thirdPartyServices: 3,
              legalAction: 2
            }
          },
          {
            id: 20,
            overtitle: "Notice of Objection",
            title: "Stop infringing goods entering the country",
            description: "Lodge a notice of objection with the Australian Border Force.",
            responseType: ["Enforcement", "Proactive", "Professional"],
            right: "Trade mark; Copyright",
            scores: {
              timeCommitment: 4,
              investment: 4,
              commercialAgreements: 2,
              thirdPartyServices: 6,
              legalAction: 5
            }
          },
          {
            id: 21,
            overtitle: "IP attorney or lawyer",
            title: "Obtain legal advice on enforcement options",
            description: "Seek a qualified & experienced professional to provide specific, tailored advice.",
            responseType: ["Enforcement", "Proactive", "Accused", "Future", "Professional"],
            right: "Any",
            scores: {
              timeCommitment: 4,
              investment: 7,
              commercialAgreements: 5,
              thirdPartyServices: 10,
              legalAction: 6
            }
          },
          {
            id: 22,
            overtitle: "International options",
            title: "Enforce your IP overseas",
            description: "Understand options relating to enforcing your IP overseas.",
            responseType: ["Enforcement", "Future", "Professional"],
            right: "Any",
            scores: {
              timeCommitment: 7,
              investment: 8,
              commercialAgreements: 6,
              thirdPartyServices: 7,
              legalAction: 7
            }
          },
          {
            id: 23,
            overtitle: "Monitor the situation",
            title: "Take no immediate action",
            description: "Strategically enforce your IP only when worthwhile.",
            responseType: ["Enforcement", "Accused", "Future"],
            right: "Any",
            scores: {
              timeCommitment: 1,
              investment: 1,
              commercialAgreements: 1,
              thirdPartyServices: 1,
              legalAction: 1
            }
          },
          {
            id: 24,
            overtitle: "Rebrand your business",
            title: "Avoid potential IP conflicts",
            description: "Strategically rebrand your business to avoid disputes.",
            responseType: ["Enforcement", "Future"],
            right: "Trade mark",
            scores: {
              timeCommitment: 8,
              investment: 7,
              commercialAgreements: 3,
              thirdPartyServices: 6,
              legalAction: 1
            }
          },
          {
            id: 25,
            overtitle: "IP insurance",
            title: "Coverage against potential future infringement",
            description: "Protect yourself from certain costs involved in IP disputes",
            responseType: ["Proactive", "Future", "Professional"],
            right: "Patents; Trade mark; Copyright",
            scores: {
              timeCommitment: 3,
              investment: 8,
              commercialAgreements: 5,
              thirdPartyServices: 7,
              legalAction: 4
            }
          },
          {
            id: 26,
            overtitle: "Domain Name Dispute (auDRP)",
            title: "Dispute a domain name that infringes your trade mark",
            description: "Dispute an .au domain name that may infringe an IP right",
            responseType: ["Enforcement", "Professional"],
            right: "Trade mark",
            scores: {
              timeCommitment: 5,
              investment: 6,
              commercialAgreements: 3,
              thirdPartyServices: 7,
              legalAction: 6
            }
          },
          {
            id: 27,
            overtitle: "Domain Name Dispute (UDRP)",
            title: "Challenge the use of international domain name",
            description: "Dispute an international domain name that may infringe an IP right",
            responseType: ["Enforcement", "Professional"],
            right: "Trade mark",
            scores: {
              timeCommitment: 6,
              investment: 7,
              commercialAgreements: 3,
              thirdPartyServices: 8,
              legalAction: 7
            }
          },
          {
id: 28,
            overtitle: "Apply for a trade mark",
            title: "Register your trade mark",
            description: "Strengthen your position as the registered owner of your trade mark in Australia",
            responseType: ["Proactive", "Enforcement", "Future", "Professional"],
            right: "Trade mark",
            scores: {
              timeCommitment: 4,
              investment: 5,
              commercialAgreements: 5,
              thirdPartyServices: 6,
              legalAction: 2
            }
          },
          {
            id: 29,
            overtitle: "Contact intermediaries",
            title: "Engage with product distributors",
            description: "Establish and maintain connections with suppliers, manufacturers, and resellers of your goods.",
            responseType: ["Proactive", "Enforcement", "Future"],
            right: "Any",
            scores: {
              timeCommitment: 6,
              investment: 4,
              commercialAgreements: 7,
              thirdPartyServices: 5,
              legalAction: 2
            }
          },
          {
            id: 30,
            overtitle: "IP audits",
            title: "Review your IP portfolio",
            description: "Understand and assess the health and enforceability of your IP.",
            responseType: ["Proactive", "Future", "Professional"],
            right: "Any",
            scores: {
              timeCommitment: 5,
              investment: 5,
              commercialAgreements: 4,
              thirdPartyServices: 7,
              legalAction: 2
            }
          }
        ];
        
        setStrategies(strategiesData);
        setLoading(false);
      }, []);
      
      // Calculate filtered and ranked strategies when user selections change
      React.useEffect(() => {
        if (loading) return;
        
        // First filter strategies based on selected rights and situations
        let filtered = [...strategies];
        
        // Filter by selected IP rights
        if (selectedRights.length > 0) {
          filtered = filtered.filter(strategy => {
            const strategyRights = strategy.right.split('; ');
            return selectedRights.some(right => 
              strategyRights.includes(right) || strategyRights.includes('Any')
            );
          });
        }
        
        // Filter by selected situations
        if (selectedSituations.length > 0) {
          filtered = filtered.filter(strategy => {
            return selectedSituations.some(situation => 
              strategy.responseType.includes(situation)
            );
          });
        }
        
        // Calculate preference match scores for each strategy
        const ranked = filtered.map(strategy => {
          // Initialize match score calculation
          let totalScore = 0;
          let totalWeight = 0;
          const matches = [];
          const nonMatches = [];
          
          // Helper function to calculate match for a preference
          const calculatePreferenceMatch = (preference, prefValue, strategyValue) => {
            // Skip if user has no preference (value is 0)
            if (prefValue === 0) return { score: 0, weight: 0 };
            
            // For positive preferences (user wants high value)
            if (prefValue > 0) {
              // Convert preference range -3 to 3 to expected value 0-10
              const expectedValue = (prefValue / 3) * 10;
              // Calculate match (10 is perfect match, 0 is worst)
              const score = Math.max(0, 10 - Math.abs(expectedValue - strategyValue));
              // Use preference strength as weight
              const weight = Math.abs(prefValue) / 3;
              
              return { 
                score, 
                weight,
                isMatch: score > 5
              };
            } 
            // For negative preferences (user wants low value)
            else {
              // For negative preferences, lower strategy values are better
              const score = Math.max(0, 10 - strategyValue);
              // Use preference strength as weight
              const weight = Math.abs(prefValue) / 3;
              
              return {
                score,
                weight,
                isMatch: score > 5
              };
            }
          };
          
          // Calculate matches for each preference
          const timeMatch = calculatePreferenceMatch(
            'timeCommitment', 
            preferences.timeCommitment, 
            strategy.scores.timeCommitment
          );
          
          const investmentMatch = calculatePreferenceMatch(
            'investment', 
            preferences.investment, 
            strategy.scores.investment
          );
          
          const agreementMatch = calculatePreferenceMatch(
            'commercialAgreements', 
            preferences.commercialAgreements, 
            strategy.scores.commercialAgreements
          );
          
          const serviceMatch = calculatePreferenceMatch(
            'thirdPartyServices', 
            preferences.thirdPartyServices, 
            strategy.scores.thirdPartyServices
          );
          
          const legalMatch = calculatePreferenceMatch(
            'legalAction', 
            preferences.legalAction, 
            strategy.scores.legalAction
          );
          
          // Add preference matches to the lists
          if (timeMatch.weight > 0) {
            if (timeMatch.isMatch) {
              matches.push('Time commitment');
            } else {
              nonMatches.push('Time commitment');
            }
          }
          
          if (investmentMatch.weight > 0) {
            if (investmentMatch.isMatch) {
              matches.push('Investment level');
            } else {
              nonMatches.push('Investment level');
            }
          }
          
          if (agreementMatch.weight > 0) {
            if (agreementMatch.isMatch) {
              matches.push('Commercial agreements');
            } else {
              nonMatches.push('Commercial agreements');
            }
          }
          
          if (serviceMatch.weight > 0) {
            if (serviceMatch.isMatch) {
              matches.push('Third-party services');
            } else {
              nonMatches.push('Third-party services');
            }
          }
          
          if (legalMatch.weight > 0) {
            if (legalMatch.isMatch) {
              matches.push('Legal action');
            } else {
              nonMatches.push('Legal action');
            }
          }
          
          // Calculate overall weighted score
          totalScore += timeMatch.score * timeMatch.weight;
          totalScore += investmentMatch.score * investmentMatch.weight;
          totalScore += agreementMatch.score * agreementMatch.weight;
          totalScore += serviceMatch.score * serviceMatch.weight;
          totalScore += legalMatch.score * legalMatch.weight;
          
          totalWeight += timeMatch.weight;
          totalWeight += investmentMatch.weight;
          totalWeight += agreementMatch.weight;
          totalWeight += serviceMatch.weight;
          totalWeight += legalMatch.weight;
          
          // Calculate final match score (0-100 scale)
          const matchScore = totalWeight > 0 
            ? (totalScore / (totalWeight * 10)) * 100 
            : 100; // Perfect score if no preferences set
          
          return {
            ...strategy,
            matchScore,
            matches,
            nonMatches
          };
        });
        
        // Sort by match score (highest first)
        ranked.sort((a, b) => b.matchScore - a.matchScore);
        
        setFilteredStrategies(ranked);
      }, [loading, strategies, selectedRights, selectedSituations, preferences]);
      
      // Toggle section accordion
      const toggleAccordion = (section) => {
        setAccordions({
          ...accordions,
          [section]: !accordions[section]
        });
      };
      
      // Toggle IP right selection
      const toggleRight = (rightId) => {
        if (selectedRights.includes(rightId)) {
          setSelectedRights(selectedRights.filter(id => id !== rightId));
        } else {
          setSelectedRights([...selectedRights, rightId]);
        }
      };
      
      // Toggle situation selection
      const toggleSituation = (situationId) => {
        if (selectedSituations.includes(situationId)) {
          setSelectedSituations(selectedSituations.filter(id => id !== situationId));
        } else {
          setSelectedSituations([...selectedSituations, situationId]);
        }
      };
      
      // Update preference slider
      const updatePreference = (preference, value) => {
        setPreferences({
          ...preferences,
          [preference]: value
        });
      };
      
      // Helper to get the color class for IP right
      const getRightColor = (right) => {
        if (right.includes('Patent')) return 'patent';
        if (right.includes('Trade mark')) return 'trademark';
        if (right.includes('Design')) return 'design';
        if (right.includes('PBR')) return 'pbr';
        if (right.includes('Copyright')) return 'copyright';
        return 'any';
      };
      
      // Get preference display text
      const getPreferenceText = (preference, value) => {
        // Default labels for most preferences
        const defaultLabels = {
          '-3': 'Very low',
          '-2': 'Low',
          '-1': 'Somewhat low',
          '0': 'No preference',
          '1': 'Somewhat high',
          '2': 'High',
          '3': 'Very high'
        };
        
        // Special labels for legal action
        const legalLabels = {
          '-3': 'Strongly avoid',
          '-2': 'Avoid',
          '-1': 'Prefer to avoid',
          '0': 'No preference',
          '1': 'Open to consider',
          '2': 'Willing to use',
          '3': 'Ready to pursue'
        };
        
        // Return appropriate label based on preference type
        if (preference === 'legalAction') {
          return legalLabels[value];
        }
        
        return defaultLabels[value];
      };
      
      // Show loading state
      if (loading) {
        return (
          <div className="text-center py-12">
            <div className="text-xl">Loading IP strategies...</div>
          </div>
        );
      }
      
      return (
        <div>
          <h1 className="text-3xl font-bold mb-6" style={{ color: 'var(--teal)' }}>IP Strategy Finder</h1>
          
          <div className="grid">
            {/* Left column - User selections */}
            <div>
              {/* IP Rights Section */}
              <div className="accordion mb-6">
               
                <div 
  className="accordion-header"
  onClick={() => toggleAccordion('ipRights')}
>
  <div className="accordion-title-section">
    <div className="accordion-arrow">
      {accordions.ipRights ? (
        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 20 20" fill="currentColor">
          <path fillRule="evenodd" d="M14.707 12.707a1 1 0 01-1.414 0L10 9.414l-3.293 3.293a1 1 0 01-1.414-1.414l4-4a1 1 0 011.414 0l4 4a1 1 0 010 1.414z" clipRule="evenodd" />
        </svg>
      ) : (
        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 20 20" fill="currentColor">
          <path fillRule="evenodd" d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z" clipRule="evenodd" />
        </svg>
      )}
    </div>
    <span>IP Rights</span>
  </div>
  
  <div>
    {selectedRights.length > 0 && (
      <span className="text-sm text-gray-500">{selectedRights.length} selected</span>
    )}
  </div>
</div>
                
                {accordions.ipRights && (
                  <div className="accordion-content">
                    <p className="mb-4">Select the IP rights you're interested in:</p>
                    
                    <div className="radio-group">
                      {ipRightsOptions.map(option => (
                        <label 
                          key={option.id}
                          className={`radio-button ${selectedRights.includes(option.id) ? 'selected' : ''}`}
                          onClick={() => toggleRight(option.id)}
                        >
                          {option.label}
                        </label>
                      ))}
                    </div>
                    
                    {selectedRights.length > 0 && (
                      <div className="mt-2 text-sm text-gray-600">
                        Selected: {selectedRights.join(', ')}
                      </div>
                    )}
                  </div>
                )}
              </div>
              
              {/* Situation Section */}
              <div className="accordion mb-6">
  <div 
  className="accordion-header"
  onClick={() => toggleAccordion('situation')}
>
  <div className="accordion-title-section">
    <div className="accordion-arrow">
      {accordions.situation ? (
        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 20 20" fill="currentColor">
          <path fillRule="evenodd" d="M14.707 12.707a1 1 0 01-1.414 0L10 9.414l-3.293 3.293a1 1 0 01-1.414-1.414l4-4a1 1 0 011.414 0l4 4a1 1 0 010 1.414z" clipRule="evenodd" />
        </svg>
      ) : (
        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 20 20" fill="currentColor">
          <path fillRule="evenodd" d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z" clipRule="evenodd" />
        </svg>
      )}
    </div>
    <span>Your Situation</span>
  </div>
  
  <div>
    {selectedSituations.length > 0 && (
      <span className="text-sm text-gray-500">{selectedSituations.length} selected</span>
    )}
  </div>
</div>
                
                {accordions.situation && (
                  <div className="accordion-content">
                    <p className="mb-4">Select all that apply to your situation:</p>
                    
                    <div className="checkbox-group">
                      {situationOptions.map(option => (
                        <label key={option.id} className="checkbox-label">
                          <input
                            type="checkbox"
                            checked={selectedSituations.includes(option.id)}
                            onChange={() => toggleSituation(option.id)}
                          />
                          <span>{option.label}</span>
                        </label>
                      ))}
                    </div>
                  </div>
                )}
              </div>
              
              {/* Preferences Section */}
              <div className="accordion mb-6">
   <div 
  className="accordion-header"
  onClick={() => toggleAccordion('preferences')}
>
  <div className="accordion-title-section">
    <div className="accordion-arrow">
      {accordions.preferences ? (
        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 20 20" fill="currentColor">
          <path fillRule="evenodd" d="M14.707 12.707a1 1 0 01-1.414 0L10 9.414l-3.293 3.293a1 1 0 01-1.414-1.414l4-4a1 1 0 011.414 0l4 4a1 1 0 010 1.414z" clipRule="evenodd" />
        </svg>
      ) : (
        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 20 20" fill="currentColor">
          <path fillRule="evenodd" d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z" clipRule="evenodd" />
        </svg>
      )}
    </div>
    <span>Your Preferences</span>
  </div>
  
  <div>
    {Object.values(preferences).some(v => v !== 0) && (
      <span className="text-sm text-gray-500">Preferences set</span>
    )}
  </div>
</div>
                
                {accordions.preferences && (
                  <div className="accordion-content">
                    <p className="mb-4">Adjust your preferences to find optimal strategies:</p>
                    
                    {/* Time Commitment slider */}
                    <div className="slider-container">
                      <div className="slider-header">
                        <div className="slider-label">Time commitment</div>
                        <div className={`slider-value ${preferences.timeCommitment === 0 ? 'neutral' : ''}`}>
                          {getPreferenceText('timeCommitment', preferences.timeCommitment)}
                        </div>
                      </div>
                      
                      <div className="slider-ticks">
                        <span>Low</span>
                        <span>No preference</span>
                        <span>High</span>
                      </div>
                      
                      <input
                        type="range"
                        min="-3"
                        max="3"
                        step="1"
                        value={preferences.timeCommitment}
                        onChange={(e) => updatePreference('timeCommitment', parseInt(e.target.value))}
                        className="slider"
                      />
                    </div>
                    
                    {/* Investment level slider */}
                    <div className="slider-container">
                      <div className="slider-header">
                        <div className="slider-label">Investment level</div>
                        <div className={`slider-value ${preferences.investment === 0 ? 'neutral' : ''}`}>
                          {getPreferenceText('investment', preferences.investment)}
                        </div>
                      </div>
                      
                      <div className="slider-ticks">
                        <span>Low</span>
                        <span>No preference</span>
                        <span>High</span>
                      </div>
                      
                      <input
                        type="range"
                        min="-3"
                        max="3"
                        step="1"
                        value={preferences.investment}
                        onChange={(e) => updatePreference('investment', parseInt(e.target.value))}
                        className="slider"
                      />
                    </div>
                    
                    {/* Commercial agreements slider */}
                    <div className="slider-container">
                      <div className="slider-header">
                        <div className="slider-label">Commercial agreements</div>
                        <div className={`slider-value ${preferences.commercialAgreements === 0 ? 'neutral' : ''}`}>
                          {getPreferenceText('commercialAgreements', preferences.commercialAgreements)}
                        </div>
                      </div>
                      
                      <div className="slider-ticks">
                        <span>Opposed</span>
                        <span>No preference</span>
                        <span>Open</span>
                      </div>
                      
                      <input
                        type="range"
                        min="-3"
                        max="3"
                        step="1"
                        value={preferences.commercialAgreements}
                        onChange={(e) => updatePreference('commercialAgreements', parseInt(e.target.value))}
                        className="slider"
                      />
                    </div>
                    
                    {/* Third-party services slider */}
                    <div className="slider-container">
                      <div className="slider-header">
                        <div className="slider-label">Third-party services</div>
                        <div className={`slider-value ${preferences.thirdPartyServices === 0 ? 'neutral' : ''}`}>
                          {getPreferenceText('thirdPartyServices', preferences.thirdPartyServices)}
                        </div>
                      </div>
                      
                      <div className="slider-ticks">
                        <span>Opposed</span>
                        <span>No preference</span>
                        <span>Open</span>
                      </div>
                      
                      <input
                        type="range"
                        min="-3"
                        max="3"
                        step="1"
                        value={preferences.thirdPartyServices}
                        onChange={(e) => updatePreference('thirdPartyServices', parseInt(e.target.value))}
                        className="slider"
                      />
                    </div>
                    
                    {/* Legal action slider */}
                    <div className="slider-container">
                      <div className="slider-header">
                        <div className="slider-label">Legal action</div>
                        <div className={`slider-value ${preferences.legalAction === 0 ? 'neutral' : ''}`}>
                          {getPreferenceText('legalAction', preferences.legalAction)}
                        </div>
                      </div>
                      
                      <div className="slider-ticks">
                        <span>Avoid</span>
                        <span>No preference</span>
                        <span>Pursue</span>
                      </div>
                      
                      <input
                        type="range"
                        min="-3"
                        max="3"
                        step="1"
                        value={preferences.legalAction}
                        onChange={(e) => updatePreference('legalAction', parseInt(e.target.value))}
                        className="slider"
                      />
                    </div>
                  </div>
                )}
              </div>
            </div>
            
            {/* Right column - Results */}
            <div>
              <div className="card">
                <h2 className="text-xl font-bold mb-4" style={{ color: 'var(--teal)' }}>
                  {filteredStrategies.length > 0 
                    ? 'Potential IP Strategies' 
                    : 'Select criteria to see potential strategies'}
                </h2>
                
                {filteredStrategies.length === 0 ? (
                  <div className="bg-gray-50 p-8 text-center rounded-lg">
                    <p className="text-gray-600">
                      {selectedRights.length > 0 || selectedSituations.length > 0
                        ? 'No strategies match your current criteria. Try adjusting your selections.'
                        : 'Select your IP rights and situation to see potential strategies.'}
                    </p>
                  </div>
                ) : (
                  <div className="space-y-6" style={{ maxHeight: '700px', overflowY: 'auto', paddingRight: '8px' }}>
                    {filteredStrategies.map(strategy => {
                      // Get the right color for the border
                      const rights = strategy.right.split('; ');
                      const mainRight = rights[0];
                      const borderClass = `border-${getRightColor(mainRight)}`;
                      
                      return (
                        <div key={strategy.id} className={`strategy-card ${borderClass}`}>
                          {/* Left side - Strategy details */}
                          <div className="card-left">
                            <div className="text-sm text-gray-500 mb-1">{strategy.overtitle}</div>
                            <h3 className="text-lg font-semibold mb-2">{strategy.title}</h3>
                            <p className="text-gray-700 mb-4">{strategy.description}</p>
                            
                            <div className="flex flex-wrap gap-2">
                              {/* IP Right tags */}
                              {rights.map((right, i) => (
                                <span key={`right-${i}`} className={`tag tag-${getRightColor(right)}`}>
                                  {right}
                                </span>
                              ))}
                              
                              {/* Response Type tags */}
                              {strategy.responseType.map((type, i) => (
                                <span key={`response-${i}`} className="tag" style={{ 
                                  backgroundColor: 'rgba(120, 122, 187, 0.1)', 
                                  color: 'var(--highlight)' 
                                }}>
                                  {type}
                                </span>
                              ))}
                            </div>
                          </div>
                          
                          {/* Right side - Match details */}
                          <div className="card-right">
                            <div>
                              <div className="match-text">
                                <span>Relevance</span>
                              </div>
                              
                              <div className="relevance-box">
                                <div className={`relevance-level relevance-none ${strategy.matchScore > 0 ? 'level-active' : 'level-inactive'}`}></div>
                                <div className={`relevance-level relevance-low ${strategy.matchScore > 1 ? 'level-active' : 'level-inactive'}`}></div>
                                <div className={`relevance-level relevance-medium ${strategy.matchScore > 25 ? 'level-active' : 'level-inactive'}`}></div>
                                <div className={`relevance-level relevance-high ${strategy.matchScore > 50 ? 'level-active' : 'level-inactive'}`}></div>
                                <div className={`relevance-level relevance-very-high ${strategy.matchScore > 75 ? 'level-active' : 'level-inactive'}`}></div>
                              </div>
                            </div>
                            
                            <div className="match-details">
                              {/* Matches */}
                              {strategy.matches.length > 0 && (
                                <div>
                                  <div className="matches">Matches your preferences</div>
                                  <ul className="match-list good">
                                    {strategy.matches.map((match, i) => (
                                      <li key={`match-${i}`}>{match}</li>
                                    ))}
                                  </ul>
                                </div>
                              )}
                              
                              {/* Non-matches */}
                              {strategy.nonMatches.length > 0 && (
                                <div>
                                  <div className="non-matches">May not suit your preferences</div>
                                  <ul className="match-list bad">
                                    {strategy.nonMatches.map((nonMatch, i) => (
                                      <li key={`nonmatch-${i}`}>{nonMatch}</li>
                                    ))}
                                  </ul>
                                </div>
                              )}
                            </div>
                          </div>
                        </div>
                      );
                    })}
                  </div>
                )}
              </div>
            </div>
          </div>
        </div>
      );
    };

    // Render the app
    ReactDOM.render(
      <IPStrategyFinder />,
      document.getElementById('app')
    );
  </script>
</body>
</html>
